# Catalyst Center Tags Playbook Config Generator Schema
# ======================================================================================
#
# This schema defines the configuration structure for generating YAML playbook
# configurations from existing tags infrastructure in Cisco Catalyst Center
# using the tags_playbook_config_generator module.
#
# SCHEMA OVERVIEW:
# ---------------
# The schema supports configuration generation operations for:
# 1. Tag Configurations - Extract existing tag definitions and their rules
# 2. Tag Membership Configurations - Extract existing tag-to-device/interface associations  
# 3. Combined Operations - Generate multiple component configurations
# 4. Filtered Generation - Selective component extraction with filters
#
# USAGE:
# ------
# This schema validates YAML configuration files for automating the extraction
# and generation of tag configurations from existing
# Catalyst Center deployments (tag playbook config generator scenarios).
#
# TOP-LEVEL PARAMETERS:
# -------------------
# catalyst_center_version:           Catalyst Center version (optional, overrides host file)
# catalyst_center_verify:            SSL certificate verification (optional, default: false)  
# catalyst_center_api_task_timeout:  API task timeout in seconds (optional, default: 1200)
# catalyst_center_debug:             Enable debug mode (optional, default: false)
# catalyst_center_log:               Enable logging (optional, default: false)
# catalyst_center_log_append:        Append to log file (optional, default: true)
# catalyst_center_log_file_path:     Log file path (optional, default: 'dnac.log')
# catalyst_center_log_level:         Log level (CRITICAL, ERROR, WARNING, INFO, DEBUG)
# catalyst_center_config_verify:     Configuration verification (optional, default: false)
#
# TAGS_PLAYBOOK_CONFIG SECTION:
# --------------------------------------------
# Contains configuration for generating YAML configurations from existing tags infrastructure:
#
# 1. GENERATE_ALL_CONFIGURATIONS:
#    - Type: boolean (optional, default: false)
#    - Description: If true, generates configurations for all components regardless of filters
#    - When true, overrides any component_specific_filters settings
#    - Retrieves all tag configurations and tag memberships from Catalyst Center
#
# 2. FILE_PATH:
#    - Type: string (optional)
#    - Description: Output path where the YAML configuration file will be saved
#    - If not provided, auto-generates filename with timestamp
#    - Format: tags_workflow_manager_playbook_<timestamp>.yml
#    - Example: tags_workflow_manager_playbook_2026-01-24_12-33-20.yml
#    - Supports absolute and relative paths
#    - Creates directory structure if it doesn't exist
#
# 3. COMPONENT_SPECIFIC_FILTERS:
#    - Type: dictionary (optional)
#    - Description: Filters to specify which components to include in the generated configuration
#    - If generate_all_configurations is true, these filters are ignored
#    
#    Sub-options:
#    - COMPONENTS_LIST:
#      - Type: list of strings (optional, default: ["tag", "tag_memberships"])
#      - Description: List of components to include in the YAML configuration file
#      - Valid values:
#        * "tag" - Include only tag configurations in the generated configuration
#        * "tag_memberships" - Include only tag membership configurations in the generated configuration
#        * ["tag", "tag_memberships"] - Include both components
#      - If empty list provided, defaults to all supported components
#      - Invalid components will result in error
#
#    - TAG:
#      - Type: list of dictionaries (optional)
#      - Description: Filter tag configurations by specific criteria
#      - Sub-options:
#        * tag_name: Tag name to filter by
#      
#    - TAG_MEMBERSHIPS:
#      - Type: list of dictionaries (optional)
#      - Description: Filter tag membership configurations by specific criteria
#      - Sub-options:
#        * tag_name: Tag name to filter memberships by
#
# GENERATED OUTPUT STRUCTURE:
# --------------------------
# The generated YAML file will contain a 'config' section with the following structure:
#
# config:
#   - tag:
#       name: "Production"
#       description: "Production environment devices"
#       device_rules:
#         rule_descriptions:
#           - rule_name: "device_name"
#             search_pattern: "contains"
#             value: "prod"
#             operation: "ILIKE"
#         rule_descriptions:
#           - rule_name: "port_name"
#             search_pattern: "starts_with"
#             value: "GigabitEthernet"
#             operation: "ILIKE"
#   - tag_memberships:
#       tags: ["Production"]
#       device_details:
#         - serial_numbers: ["ABC123DEF456"]

# OPERATION WORKFLOWS:
# -------------------
# 1. Configuration Generation (All Components):
#    a. Set generate_all_configurations: true
#    b. Optionally specify file_path
#    c. All existing tag configurations and tag memberships will be extracted
#
# 2. Selective Component Generation:
#    a. Use component_specific_filters with components_list
#    b. Specify required components from ["tag", "tag_memberships"]
#    c. Only specified components will be extracted
#
# 3. Filtered Component Extraction:
#    a. Use component-specific filters (tag, tag_memberships)
#    b. Apply filters like tag_name
#    c. Extract only components matching the specified criteria
#
# 4. Custom Output Path:
#    a. Specify file_path parameter
#    b. Can use absolute or relative paths
#    c. Directory structure will be created if needed
#
# 5. Default Behavior:
#    a. If no filters specified, all components are generated
#    b. If no file_path specified, auto-generates filename
#    c. Generated in current working directory or specified path
#
# EXAMPLES:
# --------
# See the vars/ directory for comprehensive example configuration files demonstrating
# different usage patterns and scenarios.

# Schema Definition
tags_config: list(include('tags_config_generator'), min=1, max=100, required=True)

# Optional Catalyst Center connection parameters
catalyst_center_version: str(required=False)
catalyst_center_verify: bool(required=False)
catalyst_center_api_task_timeout: int(min=60, max=3600, required=False)
catalyst_center_debug: bool(required=False)
catalyst_center_log: bool(required=False)
catalyst_center_log_append: bool(required=False)
catalyst_center_log_file_path: str(required=False)
catalyst_center_log_level: str(required=False)
catalyst_center_config_verify: bool(required=False)

---
# Tags Configuration Generator Schema
tags_config_generator:
  # Generate all configurations flag
  generate_all_configurations: bool(required=False)
  
  # Output file path
  file_path: str(required=False)
  
  # Component-specific filters
  component_specific_filters: include('tags_component_filters', required=False)

---
# Tags Component Filters Schema
tags_component_filters:
  # List of components to include
  components_list: list(enum("tag", "tag_memberships"), min=0, max=10, required=False)
  
  # Tag configuration filters
  tag: list(include('tag_filter'), min=0, max=100, required=False)
  
  # Tag membership configuration filters  
  tag_memberships: list(include('tag_memberships_filter'), min=0, max=100, required=False)

---
# Tag Filter Schema
tag_filter:
  # Tag name for filtering tag configurations
  tag_name: str(required=True)

---
# Tag Memberships Filter Schema
tag_memberships_filter:
  # Tag name for filtering tag membership configurations
  tag_name: str(required=True)
